Meta_gene_abundance.py has been developed for metagenomic analysis to output values of depth and abundance of genes
based on the output files from SAMtools and Prodigal. This method, using the depth file generated through mapping
reads to contigs instead of genes, performs much better and avoids producing length-dependent gene abundances.


Copyright ©Mengyun Chen, School of Life Sciences, South China Normal University
          ©Wenkai Teng, Department of Ocean Science and Engineering, Southern University of Science and Technology
          
          The script and test data can be freely copied.


Meta_gene_abundance.py is a Python2/3 compatible script.

Usage:  python Meta_gene_abundance.py -d input_depth_file -g input_gff_file -n reads_number -o output_abundance_file

    -d  Name of input depth file generated by the command 'samtools depth'
    -g  Name of input GFF file generated by Prodigal
    -n  Number of paired reads
    -o  Name of output abundance file. This file contains three columns, i.e. gene ID, coverage depth and abundance value

If you encounter problems, please contact chenmy33@m.scnu.edu.cn or tengwk@sustech.edu.cn

Recommended pipline:

  bwa index -p meta_contigs meta_contigs.fa
  bwa mem -t 20 meta_contigs clean_1.fq clean_2.fq > meta_contigs.sam
  samtools view -bS --threads 20 meta_contigs.sam > meta_contigs.bam
  samtools sort meta_contigs.bam -o meta_contigs_sorted.bam --threads 20
  samtools depth meta_contigs_sorted.bam > meta_contigs_depth.txt
  
  prodigal -a protein.faa -d gene.fna -f gff -g 11 -i meta_contigs.fa -o gene.gff -s gene.stat -p meta -q
  python Meta_gene_abundance.py -d meta_contigs_depth.txt -g gene.gff -n [Int] -o gene_abundance.txt

